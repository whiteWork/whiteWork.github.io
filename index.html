<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>测地址</title>
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link href="sun.ico" rel="icon" type="image/x-icon" />
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/index.css">
    <script src="js/common.js"></script>
    <script src="js/move.js"></script>
    <script src="js/jquery-1.10.2.js"></script>
</head>
<body>
    <div class="add_address1" id="add_addressBox">
            <!-- <nav>
                <div class="nav_left">
                    <a href="javascript:history.go(-1);" class="go_back"></a>
                </div>
                <h2>我的地址</h2>
            </nav> -->
                <div class="main">
                    <div class="address_des">
                        <ul>
                            <li class="lbs">
                                <div id="allmap"></div><i></i><input type="text" id="address" placeholder="11111111111" /><b></b>
                            </li>
                            <li>
                                <input type="text" id="house_number" placeholder=""/><b></b>
                            </li>
                        </ul>
                    </div>
                    <div class="del_address"><a href="javascript:;">删除地址</a></div>
                </div>
                <div class="setBtn"><a href="javascript:;" id="sava_address">保存</a></div>

    </div>
    <div class="commont_popup2">
        <div class="main">
            <p class="hint_txt">是否删除收货地址</p>
            <div class="popup_btn">
                <a href="javascript:;" class="cancel_btn">取消</a>
                <a href="javascript:;" class="confirm_btn">确定</a>
            </div>
        </div>
    </div>
    <div class="commont_popup">
        <div class="main">
            <p class="hint_txt">删除成功!</p>
            <a href="javascript:;" class="confirm_txt">确定</a>
        </div>
    </div>
    <script src="http://api.map.baidu.com/api?v=1.5&ak=EvERZn6ZoRjgOIkORVElG3bWtybQOA9n" type="text/javascript"></script>
    <script type="text/javascript" src="http://developer.baidu.com/map/jsdemo/demo/convertor.js"></script>
    <script type="text/javascript">
        var LBS=document.getElementById("address");
        getLocation();
        function getLocation(){
            if(navigator.geolocation){
                navigator.geolocation.getCurrentPosition(showPosition,onError);
            }else{
                tishi("您的浏览器不支持地理定位");
            }
        }
        function showPosition(position){
            lat=position.coords.latitude;
            lon=position.coords.longitude;
            var gpsPoint  = new BMap.Point(lon, lat); 
            var map = new BMap.Map("allmap");            // 创建Map实例
            map.centerAndZoom(gpsPoint ,15);  
            map.addControl(new BMap.NavigationControl());
            setTimeout(function(){
                 BMap.Convertor.translate(gpsPoint ,0,translateCallback); 
            }, 1000);
        }
        translateCallback = function (point){
            var marker = new BMap.Marker(point);
            var gc = new BMap.Geocoder();
            gc.getLocation(point, function(rs){
                var addComp = rs.addressComponents;
                if(addComp.province==addComp.city){
                    LBS.value =  addComp.city +addComp.district +addComp.street + addComp.streetNumber;
                    localStorage.setItem('address',LBS.value );

                }else{
                    LBS.value  = addComp.province + addComp.city +addComp.district +addComp.street + addComp.streetNumber;
                    localStorage.setItem('address',LBS.value );

                }
            });
        }

        function onError(error){
            switch(error.code){
               case 1:
               tishi("位置服务被拒绝,请手动输入",2000);
               break;

               case 2:
               tishi("暂时获取不到位置信息,请手动输入",2000);
               break;

               case 3:
               tishi("获取信息超时,请手动输入",2000);
               break;

               case 4:
                tishi("未知错误,请手动输入",2000);
               break;
            }
        }
    </script>
</body>
</html>